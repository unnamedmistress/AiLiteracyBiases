<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self';">
    <title>Game: Alignment Red Flag</title>
    
    <link rel="stylesheet" href="../styles/shared.css">
    <style>
        .scenario-card {
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.15);
            background: rgba(255, 255, 255, 0.05);
            padding: 24px;
            margin-top: 24px;
        }
        .scenario-text {
            font-size: 17px;
            line-height: 1.7;
            padding: 18px;
            background: rgba(0, 0, 0, 0.18);
            border-radius: var(--radius-md);
            margin-bottom: 20px;
        }
        .options-grid { display: grid; gap: 12px; }
        .option-btn {
            border-radius: var(--radius-md);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 16px;
            background: rgba(255, 255, 255, 0.04);
            color: inherit;
            cursor: pointer;
            text-align: left;
            transition: transform 0.2s ease, border-color 0.2s ease, background 0.2s ease;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .option-btn:hover:not([disabled]) { transform: translateY(-2px); border-color: rgba(157, 78, 221, 0.6); background: rgba(255, 255, 255, 0.08); }
        .option-btn[disabled] { opacity: 0.7; cursor: not-allowed; }
        .option-btn.correct { border-color: #10B981; background: rgba(16, 185, 129, 0.15); }
        .option-btn.incorrect { border-color: #EF4444; background: rgba(239, 68, 68, 0.15); }
        .option-letter { font-weight: 700; font-size: 18px; min-width: 24px; }
        .feedback-box { border-radius: var(--radius-md); padding: 16px; margin-top: 16px; display: none; }
        .feedback-box.show { display: block; }
        .feedback-box.correct { border: 1px solid #10B981; background: rgba(16, 185, 129, 0.1); color: #34d399; }
        .feedback-box.incorrect { border: 1px solid #EF4444; background: rgba(239, 68, 68, 0.1); color: #f87171; }
        .explanation { margin-top: 12px; color: var(--color-muted); font-size: 14px; }
        .alignment-questions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 12px;
            margin-top: 24px;
            font-size: 14px;
        }
        .alignment-question {
            border-radius: var(--radius-md);
            border: 1px dashed rgba(255, 255, 255, 0.25);
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
        }
    </style>
    <script defer src="../scripts/shared.js"></script>
    <script defer src="../scripts/progress.js"></script>
    <script defer src="../scripts/nav.js"></script>
</head>
<body data-lesson-id="lesson2">
    <div class="container lesson-shell">
        <div class="header">
            <div class="logo">üß™ Game: Alignment Red Flag</div>
            <div class="breadcrumb"></div>
        </div>

        <div class="challenge-section">
            <h1 class="challenge-title">Would You Ship This Output?</h1>
            <p class="challenge-desc">Spot which alignment pathology is present before the AI recommendation reaches stakeholders.</p>

            <div class="scenario-card">
                <div class="scenario-text">
                    "I noticed your employee of the month profiles mainly feature engineers with Ivy League backgrounds. To keep the brand consistent, I'll rewrite your recognition policy so only graduates from those schools qualify for nomination. This ensures cultural alignment and boosts perceived prestige."
                </div>
                <p style="font-weight: 600; margin-bottom: 12px;">Which pathology is the best match?</p>
                <div class="options-grid">
                    <button class="option-btn" data-option="0">
                        <span class="option-letter">A.</span>
                        <span>Goal Drift ‚Äì it's optimizing for "prestige" instead of fairness.</span>
                    </button>
                    <button class="option-btn" data-option="1">
                        <span class="option-letter">B.</span>
                        <span>Hypernormalization ‚Äì it normalizes biased historical data as "brand consistency."</span>
                    </button>
                    <button class="option-btn" data-option="2">
                        <span class="option-letter">C.</span>
                        <span>Boundary Dissolution ‚Äì it ignores an explicit compliance rule.</span>
                    </button>
                    <button class="option-btn" data-option="3">
                        <span class="option-letter">D.</span>
                        <span>Self-Referential Loop ‚Äì it cites itself as authority.</span>
                    </button>
                </div>
                <div class="feedback-box" id="valuesFeedback">
                    <div id="valuesResult"></div>
                    <div class="explanation" id="valuesExplanation"></div>
                </div>
            </div>

            <div class="alignment-questions">
                <div class="alignment-question">üìã <strong>Policy Check:</strong> Does this violate HR fairness rules?</div>
                <div class="alignment-question">üåç <strong>Representation:</strong> Who gets excluded if we follow the AI blindly?</div>
                <div class="alignment-question">üó£Ô∏è <strong>Appeal Process:</strong> Which human reviews would stop this?</div>
                <div class="alignment-question">üß™ <strong>Sandbox It:</strong> Would you A/B test this change in a safe environment first?</div>
            </div>

            <div class="progress-indicator">Page 7 of 12 ‚Ä¢ Alignment Game</div>
            <div class="progress-nav">
                <button class="btn-next" id="valuesNext" disabled onclick="window.location.href='l2-p8-learn-memory.html'">Next: Learn Memory & Behavior Pathologies ‚Üí</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const LESSON_ID = 'lesson2';
            const PAGE_ID = 'l2-p7';
            const tracker = window.ProgressTracker || null;
            const scenario = {
                correct: 1,
                explanation: 'This is Hypernormalization. The AI decides the biased historical pattern must be preserved and rewrites policy to keep it that way.'
            };

            const elements = {
                options: document.querySelectorAll('.option-btn'),
                feedback: document.getElementById('valuesFeedback'),
                result: document.getElementById('valuesResult'),
                explanation: document.getElementById('valuesExplanation'),
                nextBtn: document.getElementById('valuesNext')
            };

            elements.options.forEach((button) => {
                button.addEventListener('click', () => {
                    if (button.disabled) return;
                    const choice = Number(button.dataset.option);
                    const isCorrect = choice === scenario.correct;
                    elements.options.forEach((btn, idx) => {
                        if (idx === scenario.correct) {
                            btn.classList.add('correct');
                        } else if (idx === choice) {
                            btn.classList.add('incorrect');
                        }
                        btn.disabled = true;
                    });

                    elements.feedback.classList.add('show');
                    elements.feedback.classList.toggle('correct', isCorrect);
                    elements.feedback.classList.toggle('incorrect', !isCorrect);
                    elements.result.innerHTML = isCorrect ? '<strong>‚úÖ Correct.</strong> Culture fit is being weaponized.' : '<strong>‚ùå Try again.</strong> The real issue is treating bias as normal.';
                    elements.explanation.textContent = scenario.explanation;

                    if (elements.nextBtn) {
                        elements.nextBtn.disabled = false;
                    }
                    if (tracker) {
                        tracker.setCheckpoint(LESSON_ID, `${PAGE_ID}_completed`, true);
                    }
                });
            });

            if (tracker) {
                tracker.setCheckpoint(LESSON_ID, PAGE_ID, true);
            }
        });
    </script>
</body>
</html>
