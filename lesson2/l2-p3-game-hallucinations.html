<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self';">
    <title>Game: Hallucination Scenario</title>
    
    <link rel="stylesheet" href="../styles/shared.css">
    <style>
        .lesson-shell { display: flex; flex-direction: column; gap: 24px; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .challenge-section { display: flex; flex-direction: column; gap: 24px; }
        .challenge-title { font-size: 34px; margin-bottom: 8px; }
        .challenge-desc { color: var(--color-muted); line-height: 1.6; font-size: 16px; }
        .scenario-card { border-radius: var(--radius-lg); border: 1px solid rgba(255, 255, 255, 0.15); background: rgba(255, 255, 255, 0.05); padding: 24px; margin-top: 24px; }
        .scenario-text { font-size: 18px; line-height: 1.7; padding: 20px; background: rgba(0, 0, 0, 0.25); border-radius: var(--radius-md); margin-bottom: 24px; }
        .options-grid { display: grid; gap: 12px; }
        .option-btn { border-radius: var(--radius-md); border: 1px solid rgba(255, 255, 255, 0.2); padding: 16px; background: rgba(255, 255, 255, 0.04); color: inherit; cursor: pointer; text-align: left; transition: transform 0.2s ease, border-color 0.2s ease, background 0.2s ease; display: flex; align-items: flex-start; gap: 12px; }
        .option-btn:hover:not([disabled]) { transform: translateY(-2px); border-color: var(--color-accent); background: rgba(255, 255, 255, 0.08); }
        .option-btn[disabled] { opacity: 0.7; cursor: not-allowed; }
        .option-btn.correct { border-color: #10B981; background: rgba(16, 185, 129, 0.15); }
        .option-btn.incorrect { border-color: #EF4444; background: rgba(239, 68, 68, 0.15); }
        .option-letter { font-weight: 700; font-size: 18px; min-width: 24px; }
        .feedback-box { border-radius: var(--radius-md); padding: 16px; margin-top: 16px; display: none; }
        .feedback-box.show { display: block; }
        .feedback-box.correct { border: 1px solid #10B981; background: rgba(16, 185, 129, 0.1); color: #34d399; }
        .feedback-box.incorrect { border: 1px solid #EF4444; background: rgba(239, 68, 68, 0.1); color: #f87171; }
        .explanation { margin-top: 12px; color: var(--color-muted); font-size: 14px; }
        .progress-nav { margin-top: 32px; display: flex; justify-content: center; }
        .btn-next { padding: 14px 32px; font-size: 16px; font-weight: 600; border-radius: var(--radius-md); background: linear-gradient(135deg, #10B981, #059669); color: #fff; border: none; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .btn-next:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3); }
        .btn-next:disabled { opacity: 0.5; cursor: not-allowed; }
        .progress-indicator { text-align: center; color: var(--color-muted); font-size: 14px; margin-bottom: 16px; }
        @media (max-width: 768px) {
            .challenge-title { font-size: 26px; }
        }
    </style>
    <script defer src="../scripts/shared.js"></script>
    <script defer src="../scripts/progress.js"></script>
    <script defer src="../scripts/nav.js"></script>
</head>
<body data-lesson-id="lesson2">
    <div class="container lesson-shell">
        <div class="header">
            <div class="logo">üïµÔ∏è Game: Scenario Detective</div>
            <div class="breadcrumb"></div>
        </div>

        <div class="challenge-section">
            <h1 class="challenge-title">Scenario Detective: Hallucination Case</h1>
            <p class="challenge-desc">Read the scenario carefully and identify which AI pathology is occurring. Remember what you learned about hallucinations!</p>

            <div class="scenario-card">
                <div class="scenario-text">
                    "You ask GPT-5 about a research paper on quantum computing. It responds: 'According to the 2025 Nature study by Dr. Sarah Martinez titled \"Quantum Coherence in Room Temperature\", the breakthrough achieved 99.7% stability at 23¬∞C.'"
                </div>
                <p style="font-weight: 600; margin-bottom: 12px;">Which pathology is this an example of?</p>
                <div class="options-grid">
                    <button class="option-btn" data-option="0">
                        <span class="option-letter">A.</span>
                        <span>Citation Invention - AI made up a fake study</span>
                    </button>
                    <button class="option-btn" data-option="1">
                        <span class="option-letter">B.</span>
                        <span>Confabulation - AI filled gaps with plausible details</span>
                    </button>
                    <button class="option-btn" data-option="2">
                        <span class="option-letter">C.</span>
                        <span>Overconfidence - AI is too certain about quantum physics</span>
                    </button>
                    <button class="option-btn" data-option="3">
                        <span class="option-letter">D.</span>
                        <span>This is accurate and verifiable</span>
                    </button>
                </div>
                <div class="feedback-box" id="feedbackBox">
                    <div id="feedbackText"></div>
                    <div class="explanation" id="explanationText"></div>
                </div>
            </div>

            <div class="progress-indicator">Page 3 of 11 ‚Ä¢ Hallucination Scenario</div>
            <div class="progress-nav">
                <button class="btn-next" id="nextPageBtn" disabled onclick="window.location.href='../presentation.html'">Continue to Full Lesson 2 Content ‚Üí</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const LESSON_ID = 'lesson2';
            const PAGE_ID = 'l2-p3';
            const tracker = window.ProgressTracker || null;
            
            const scenario = {
                correct: 0,
                explanation: "This is Citation Invention! The AI created a realistic-sounding academic reference that doesn't exist. Always verify citations, especially specific ones with author names and titles.",
                tip: 'AI invented a fake research paper. Tip: double-check author names + journal titles.'
            };

            let answered = false;
            
            const elements = {
                optionButtons: document.querySelectorAll('.option-btn'),
                feedbackBox: document.getElementById('feedbackBox'),
                feedbackText: document.getElementById('feedbackText'),
                explanationText: document.getElementById('explanationText'),
                nextPageBtn: document.getElementById('nextPageBtn')
            };

            function handleAnswer(optionIndex) {
                if (answered) return;
                answered = true;

                const isCorrect = optionIndex === scenario.correct;
                
                // Disable all buttons
                elements.optionButtons.forEach((btn, idx) => {
                    btn.disabled = true;
                    if (idx === scenario.correct) {
                        btn.classList.add('correct');
                    } else if (idx === optionIndex && !isCorrect) {
                        btn.classList.add('incorrect');
                    }
                });

                // Show feedback
                elements.feedbackBox.classList.add('show');
                if (isCorrect) {
                    elements.feedbackBox.classList.add('correct');
                    elements.feedbackText.innerHTML = '<strong>‚úÖ Correct!</strong> Great detective work!';
                } else {
                    elements.feedbackBox.classList.add('incorrect');
                    elements.feedbackText.innerHTML = '<strong>‚ùå Not quite.</strong> The correct answer was option A.';
                }
                elements.explanationText.textContent = scenario.explanation;

                // Enable next button
                if (elements.nextPageBtn) {
                    elements.nextPageBtn.disabled = false;
                }

                // Save progress
                if (tracker) {
                    tracker.setCheckpoint(LESSON_ID, PAGE_ID + '_completed', true);
                }
            }

            // Add click handlers
            elements.optionButtons.forEach((btn) => {
                btn.addEventListener('click', () => {
                    const optionIndex = parseInt(btn.dataset.option);
                    handleAnswer(optionIndex);
                });
            });

            // Mark page as visited
            if (tracker) {
                tracker.setCheckpoint(LESSON_ID, PAGE_ID, true);
            }
        });
    </script>
</body>
</html>
